---
import SectionHeader from "./SectionHeader.astro";
import UiIcon from "./icons/UiIcon.astro";

const {
  eyebrow = "Servizi",
  title,
  subtitle,
  services,
  maxItems,
  cardCtaLabel = "Scopri di pi√π",
} = Astro.props as {
  eyebrow?: string;
  title: string;
  subtitle?: string;
  services: Array<{
    slug: string;
    title: string;
    short: string;
    image: { src: string; alt: string; ratio?: "4/3" | "3/2" | "1/1" };
  }>;
  maxItems?: number;
  cardCtaLabel?: string;
};

const visibleServices = typeof maxItems === "number" ? services.slice(0, maxItems) : services;
const gridColsClass =
  visibleServices.length <= 1
    ? "grid-cols-1"
    : visibleServices.length === 2
      ? "grid-cols-1 md:grid-cols-2"
      : "grid-cols-1 md:grid-cols-2 xl:grid-cols-3";
---

<section class="section-y surface-section">
  <div class="site-container">
    <SectionHeader eyebrow={eyebrow} title={title} subtitle={subtitle} />

    <div class={`mt-8 grid gap-5 motion-stagger ${gridColsClass}`} data-stagger="services-grid">
      {visibleServices.map((service) => (
        <article class="card-base card-hover service-card overflow-hidden motion-stagger-item motion-reveal-up" data-stagger-item>
          <div class="service-card-media-wrap">
            <img
              src={service.image.src}
              alt={service.image.alt}
              class="card-media service-card-media motion-zoom"
              style={`aspect-ratio:${service.image.ratio ?? "4/3"};`}
              loading="lazy"
              decoding="async"
            />
            <div class="service-card-overlay" aria-hidden="true"></div>
          </div>
          <div class="service-card-content p-5">
            <h3 class="text-lg font-semibold text-slate-900">{service.title}</h3>
            <p class="mt-2 text-sm leading-6 text-slate-600">{service.short}</p>
            <a href={`/servizi/${service.slug}`} class="service-card-link motion-link mt-4 inline-flex items-center gap-2 text-sm font-semibold text-[color:var(--color-primary)] hover:text-[color:var(--color-primary-600)]">
              {cardCtaLabel}
              <UiIcon name="arrow-right" class="service-card-arrow" />
            </a>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>
