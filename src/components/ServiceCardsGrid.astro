---
import SectionHeader from "./SectionHeader.astro";
import UiIcon from "./icons/UiIcon.astro";

const {
  eyebrow = "Servizi",
  title,
  subtitle,
  services,
  maxItems,
  cardCtaLabel = "Scopri di pi√π",
} = Astro.props as {
  eyebrow?: string;
  title: string;
  subtitle?: string;
  services: Array<{
    slug: string;
    title: string;
    short: string;
    image: { src: string; alt: string; ratio?: "4/3" | "3/2" | "1/1" };
  }>;
  maxItems?: number;
  cardCtaLabel?: string;
};

const visibleServices = typeof maxItems === "number" ? services.slice(0, maxItems) : services;
---

<section class="section-y surface-section">
  <div class="site-container">
    <SectionHeader eyebrow={eyebrow} title={title} subtitle={subtitle} />

    <div class="mt-8 grid gap-4 md:grid-cols-2 xl:grid-cols-4" data-stagger="services-grid">
      {visibleServices.map((service) => (
        <article class="card-base card-hover overflow-hidden" data-stagger-item>
          <img
            src={service.image.src}
            alt={service.image.alt}
            class="card-media"
            style={`aspect-ratio:${service.image.ratio ?? "4/3"};`}
            loading="lazy"
            decoding="async"
          />
          <div class="p-4">
            <h3 class="text-base font-semibold text-slate-900">{service.title}</h3>
            <p class="mt-2 text-sm text-slate-600">{service.short}</p>
            <a href={`/servizi/${service.slug}`} class="mt-3 inline-flex items-center gap-1.5 text-sm font-semibold text-[color:var(--color-primary)] hover:text-[color:var(--color-primary-600)]">
              {cardCtaLabel}
              <UiIcon name="arrow-right" class="h-[1rem] w-[1rem]" />
            </a>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>
